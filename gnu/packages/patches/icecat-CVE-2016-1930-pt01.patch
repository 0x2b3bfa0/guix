Copied from: https://hg.mozilla.org/releases/mozilla-esr38/rev/925215cae26f
Security advisory: https://www.mozilla.org/en-US/security/advisories/mfsa2016-01/
Mozilla Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=1233346

# HG changeset patch
# User Nils Ohlmeier <drno@ohlmeier.org>
# Date 1451439902 18000
# Node ID 925215cae26f9c0ccff07ef403a5b3194a4c45c4
# Parent  ff8e52467d793e935b80bf22a722a71a96fe2d63
Bug 1233346 - r=ekr a=abillings

diff --git a/media/mtransport/third_party/nICEr/src/stun/addrs.c b/media/mtransport/third_party/nICEr/src/stun/addrs.c
--- a/media/mtransport/third_party/nICEr/src/stun/addrs.c
+++ b/media/mtransport/third_party/nICEr/src/stun/addrs.c
@@ -530,16 +530,18 @@ stun_get_win32_addrs(nr_local_addr addrs
 
     for (tmpAddress = AdapterAddresses; tmpAddress != NULL; tmpAddress = tmpAddress->Next) {
       char *c;
 
       if (tmpAddress->OperStatus != IfOperStatusUp)
         continue;
 
       snprintf(munged_ifname, IFNAMSIZ, "%S%c", tmpAddress->FriendlyName, 0);
+      munged_ifname[IFNAMSIZ-1] = '\0';
+
       /* replace spaces with underscores */
       c = strchr(munged_ifname, ' ');
       while (c != NULL) {
         *c = '_';
          c = strchr(munged_ifname, ' ');
       }
       c = strchr(munged_ifname, '.');
       while (c != NULL) {

