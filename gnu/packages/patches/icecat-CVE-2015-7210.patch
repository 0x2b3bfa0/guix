From 4e0cd9ba4924869f91be0e7c8cf666182bb75f90 Mon Sep 17 00:00:00 2001
From: "Byron Campen [:bwc]" <docfaraday@gmail.com>
Date: Wed, 28 Oct 2015 12:48:17 -0500
Subject: [PATCH] Bug 1218326 - Prevent datachannel operations on closed
 PeerConnections. r=jesup a=sylvestre

--HG--
extra : source : a7637b62d9b5ab73f58e5aa3c663d7d35b624826
extra : intermediate-source : d8f0412f38f75040064157d8d2b0140df21600e6
---
 media/webrtc/signaling/src/peerconnection/PeerConnectionImpl.cpp | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/media/webrtc/signaling/src/peerconnection/PeerConnectionImpl.cpp b/media/webrtc/signaling/src/peerconnection/PeerConnectionImpl.cpp
index c3d8d26..fe86ff7 100644
--- a/media/webrtc/signaling/src/peerconnection/PeerConnectionImpl.cpp
+++ b/media/webrtc/signaling/src/peerconnection/PeerConnectionImpl.cpp
@@ -1004,7 +1004,7 @@ PeerConnectionImpl::GetIdentity() const
 NS_IMETHODIMP
 PeerConnectionImpl::EnsureDataConnection(uint16_t aNumstreams)
 {
-  PC_AUTO_ENTER_API_CALL_NO_CHECK();
+  PC_AUTO_ENTER_API_CALL(false);
 
 #ifdef MOZILLA_INTERNAL_API
   if (mDataConnection) {
@@ -1102,7 +1102,7 @@ PeerConnectionImpl::GetDatachannelParameters(
 nsresult
 PeerConnectionImpl::InitializeDataChannel()
 {
-  PC_AUTO_ENTER_API_CALL_NO_CHECK();
+  PC_AUTO_ENTER_API_CALL(false);
   CSFLogDebug(logTag, "%s", __FUNCTION__);
 
   const JsepApplicationCodecDescription* codec;
@@ -1184,7 +1184,7 @@ PeerConnectionImpl::CreateDataChannel(const nsAString& aLabel,
                                       uint16_t aStream,
                                       nsDOMDataChannel** aRetval)
 {
-  PC_AUTO_ENTER_API_CALL_NO_CHECK();
+  PC_AUTO_ENTER_API_CALL(false);
   MOZ_ASSERT(aRetval);
 
 #ifdef MOZILLA_INTERNAL_API
-- 
2.6.3

